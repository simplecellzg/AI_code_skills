# Simulation Development Best Practices Skill

**适用于Claude Code的仿真模拟开发最佳实践Skill**

## 简介

这是一个专为科学计算和仿真模拟领域设计的Claude Code Skill，汇集了多个真实项目的实践经验，涵盖GPU编程、性能优化、数值稳定性等核心领域。

## 核心特性

- 🚀 **性能优化指导** - 基于gprof、nvprof等工具的性能分析经验
- 🎮 **GPU编程最佳实践** - CUDA异步编程、同步点、竞态条件处理
- 📊 **数值稳定性保障** - 守恒律验证、边界条件处理、精度控制
- 🔍 **系统化调试方法** - 四阶段调试流程，避免盲目试错
- ✅ **测试驱动开发** - 针对仿真程序的TDD实践
- 🔄 **并行编程模式** - MPI、OpenMP、CUDA的并行策略

## 知识来源

本Skill基于以下真实项目的实践经验：

| 项目 | 技术挑战 | 关键成果 |
|------|---------|---------|
| CAPEX-GPU | GPU移植、竞态条件 | 7天完成GPU移植，解决4个race condition |
| RMI优化 | 初始化性能瓶颈 | 257倍加速，从40分钟降至14秒 |
| UGKS-IBM | 数值收敛问题 | 修正3个关键参数，收敛残差<1e-6 |
| SPARTA LLM Agent | 从零构建系统 | 5359行代码，87%测试覆盖率 |
| MPI并行化 | 数据域分解 | 单机到集群的飞跃 |

## 安装方法

1. 将 `simulation-development-best-practices.md` 文件复制到Claude Code的skills目录
2. 重启Claude Code
3. Skill将自动加载并可用

## 使用场景

在以下场景中，Skill会自动被调用：

### GPU编程
```
"实现GPU加速"
"CUDA kernel"
"移植到GPU"
"GPU性能优化"
```

### 性能优化
```
"优化性能"
"运行太慢"
"加速计算"
"减少内存使用"
"瓶颈分析"
```

### 数值稳定性
```
"数值不稳定"
"不收敛"
"出现NaN"
"负压力"
"精度问题"
```

### 并行编程
```
"MPI并行"
"多线程"
"分布式计算"
"数据域分解"
"进程间通信"
```

## 使用示例

### 示例1：GPU竞态条件调试

```
用户：我的GPU版本在多块计算时出现极端值，密度达到10^20+

Claude Code：[自动调用Skill]
→ 提供GPU竞态条件诊断清单
→ 建议同步点位置
→ 给出修复代码模板
→ 包含验证测试脚本
```

### 示例2：：性能优化

```
用户：初始化函数运行太慢，需要优化

Claude Code：[自动调用Skill]
→ 建议使用gprof进行性能剖析
→ 提供预计算优化模式
→ 给出空间分区过滤策略
→ 展示查找表技术示例
```

## 核心功能

### 1. 性能剖析先行
- 使用gprof、nvprof、Nsight等工具
- 精确定位瓶颈
- 避免盲目优化

### 2. GPU异步编程
- 理解kernel启动是异步的
- 识别需要同步的场景
- 避免竞态条件

### 3. 测试驱动开发
- 先写测试，后写代码
- 验证守恒律
- 检查收敛阶

### 4. 系统化调试
- 四阶段调试流程
- 量化验证结果
- 添加回归测试

### 5. 数值稳定性
- NaN/Inf检测
- 物理量验证
- 边界条件检查

## 适用项目

- 计算流体力学（CFD）
- 稀薄气体动力学（DSMC）
- 分子动力学（MD）
- 有限元方法（FEM）
- 其他科学计算和仿真模拟程序

## 效果对比

| 指标 | 传统开发 | 使用Skill | 提升 |
|------|---------|---------|------|
| GPU竞态条件定位 | 6-10天 | 1小时 | 90%+ |
| 性能优化 | 数周 | 数天 | 2-3x |
| 数值问题调试 | 3-5天 | 0.5-1天 | 5-6x |
| 测试覆盖率 | 30-50% | 85%+ | 70%+ |

## 相关资源

- [Claude Code Documentation](https://docs.anthropic.com/claude-code)
- [Superpowers Plugin](https://github.com/superpowers-dev/superpowers)
- 详细使用指南：`仿真模拟开发最佳实践Skill使用指南.md`

## 贡献

欢迎提交Issue和Pull Request来改进这个Skill！

## 许可证

MIT License

## 作者

基于CAPEX-GPU、RMI优化、UGKS-IBM、SPARTA LLM Agent等项目的实践经验开发

---

**让AI成为你的科学计算专家伙伴** 🚀
